{% extends 'base.html' %}
{% block content %}
<style>
#location-select {
    background-color: #343a40 !important;
    color: #ffffff !important;
    border-color: #495057 !important;
}

#location-select option {
    background-color: #343a40 !important;
    color: #ffffff !important;
}

#location-select:focus {
    background-color: #343a40 !important;
    color: #ffffff !important;
    border-color: #80bdff !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}
</style>
<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card bg-dark border-secondary profile-card">
        <div class="card-header text-light">
          <h3 class="mb-0 text-light">
            <i class="fas fa-edit me-2"></i>Edit Profile
          </h3>
          <p class="text-muted mb-0">Update your professional information</p>
        </div>
        <div class="card-body text-light dark-form">
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <!-- Basic Information -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-info-circle me-2"></i>Basic Information
              </h5>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="{{ form.headline.id_for_label }}" class="form-label">Professional Headline *</label>
                  {{ form.headline }}
                  {% if form.headline.help_text %}
                    <div class="form-text">{{ form.headline.help_text }}</div>
                  {% endif %}
                  {% if form.headline.errors %}
                    <div class="text-danger small">{{ form.headline.errors.0 }}</div>
                  {% endif %}
                </div>
                <div class="col-md-6 mb-3">
                  <label for="{{ form.location.id_for_label }}" class="form-label">Location</label>
                  {{ form.location }}
                  {% if form.location.help_text %}
                    <div class="form-text">{{ form.location.help_text }}</div>
                  {% endif %}
                  {% if form.location.errors %}
                    <div class="text-danger small">{{ form.location.errors.0 }}</div>
                  {% endif %}
                </div>
              </div>
              
              <div class="mb-3">
                <label for="{{ form.bio.id_for_label }}" class="form-label">Bio</label>
                {{ form.bio }}
                {% if form.bio.help_text %}
                  <div class="form-text">{{ form.bio.help_text }}</div>
                {% endif %}
                {% if form.bio.errors %}
                  <div class="text-danger small">{{ form.bio.errors.0 }}</div>
                {% endif %}
              </div>
              
              <div class="mb-3">
                <label for="{{ form.phone.id_for_label }}" class="form-label">Phone</label>
                {{ form.phone }}
                {% if form.phone.help_text %}
                  <div class="form-text">{{ form.phone.help_text }}</div>
                {% endif %}
                {% if form.phone.errors %}
                  <div class="text-danger small">{{ form.phone.errors.0 }}</div>
                {% endif %}
              </div>
            </div>
            
            <!-- Skills -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-tools me-2"></i>Skills
              </h5>
              <div class="mb-3">
                <label for="{{ form.skills.id_for_label }}" class="form-label">Skills *</label>
                {{ form.skills }}
                {% if form.skills.help_text %}
                  <div class="form-text">{{ form.skills.help_text }}</div>
                {% endif %}
                {% if form.skills.errors %}
                  <div class="text-danger small">{{ form.skills.errors.0 }}</div>
                {% endif %}
              </div>
            </div>
            
            <!-- Education -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-graduation-cap me-2"></i>Education
              </h5>
              <div class="mb-3">
                <label for="{{ form.education.id_for_label }}" class="form-label">Educational Background *</label>
                {{ form.education }}
                {% if form.education.help_text %}
                  <div class="form-text">{{ form.education.help_text }}</div>
                {% endif %}
                {% if form.education.errors %}
                  <div class="text-danger small">{{ form.education.errors.0 }}</div>
                {% endif %}
              </div>
            </div>
            
            <!-- Work Experience -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-briefcase me-2"></i>Work Experience
              </h5>
              <div class="mb-3">
                <label for="{{ form.work_experience.id_for_label }}" class="form-label">Work Experience *</label>
                {{ form.work_experience }}
                {% if form.work_experience.help_text %}
                  <div class="form-text">{{ form.work_experience.help_text }}</div>
                {% endif %}
                {% if form.work_experience.errors %}
                  <div class="text-danger small">{{ form.work_experience.errors.0 }}</div>
                {% endif %}
              </div>
            </div>
            
            <!-- Links -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-link me-2"></i>Professional Links
              </h5>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="{{ form.linkedin_url.id_for_label }}" class="form-label">LinkedIn</label>
                  {{ form.linkedin_url }}
                  {% if form.linkedin_url.help_text %}
                    <div class="form-text">{{ form.linkedin_url.help_text }}</div>
                  {% endif %}
                  {% if form.linkedin_url.errors %}
                    <div class="text-danger small">{{ form.linkedin_url.errors.0 }}</div>
                  {% endif %}
                </div>
                <div class="col-md-6 mb-3">
                  <label for="{{ form.github_url.id_for_label }}" class="form-label">GitHub</label>
                  {{ form.github_url }}
                  {% if form.github_url.help_text %}
                    <div class="form-text">{{ form.github_url.help_text }}</div>
                  {% endif %}
                  {% if form.github_url.errors %}
                    <div class="text-danger small">{{ form.github_url.errors.0 }}</div>
                  {% endif %}
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="{{ form.portfolio_url.id_for_label }}" class="form-label">Portfolio</label>
                  {{ form.portfolio_url }}
                  {% if form.portfolio_url.help_text %}
                    <div class="form-text">{{ form.portfolio_url.help_text }}</div>
                  {% endif %}
                  {% if form.portfolio_url.errors %}
                    <div class="text-danger small">{{ form.portfolio_url.errors.0 }}</div>
                  {% endif %}
                </div>
                <div class="col-md-6 mb-3">
                  <label for="{{ form.other_url.id_for_label }}" class="form-label">Other URL</label>
                  {{ form.other_url }}
                  {% if form.other_url.help_text %}
                    <div class="form-text">{{ form.other_url.help_text }}</div>
                  {% endif %}
                  {% if form.other_url.errors %}
                    <div class="text-danger small">{{ form.other_url.errors.0 }}</div>
                  {% endif %}
                </div>
              </div>
            </div>
            
            <!-- Resume -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-file-alt me-2"></i>Resume
              </h5>
              <div class="mb-3">
                <label for="{{ form.resume.id_for_label }}" class="form-label">Resume File</label>
                {{ form.resume }}
                {% if form.resume.help_text %}
                  <div class="form-text">{{ form.resume.help_text }}</div>
                {% endif %}
                {% if form.resume.errors %}
                  <div class="text-danger small">{{ form.resume.errors.0 }}</div>
                {% endif %}
                {% if profile.resume %}
                  <div class="mt-2">
                    <small class="text-muted">Current file: 
                      <a href="{{ profile.resume.url }}" target="_blank" class="text-primary">
                        <i class="fas fa-download me-1"></i>{{ profile.resume.name|slice:"8:" }}
                      </a>
                    </small>
                  </div>
                {% endif %}
              </div>
            </div>

            <!-- Privacy Settings -->
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-shield-alt me-2"></i>Privacy Controls
              </h5>
              <div class="form-check form-switch mb-3">
                {{ form.is_public }}
                <label class="form-check-label" for="{{ form.is_public.id_for_label }}">Make my profile visible to recruiters</label>
                {% if form.is_public.help_text %}
                  <div class="form-text">{{ form.is_public.help_text }}</div>
                {% endif %}
                {% if form.is_public.errors %}
                  <div class="text-danger small">{{ form.is_public.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_bio }}
                <label class="form-check-label" for="{{ form.show_bio.id_for_label }}">Show my bio</label>
                {% if form.show_bio.help_text %}
                  <div class="form-text">{{ form.show_bio.help_text }}</div>
                {% endif %}
                {% if form.show_bio.errors %}
                  <div class="text-danger small">{{ form.show_bio.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_location }}
                <label class="form-check-label" for="{{ form.show_location.id_for_label }}">Show my location</label>
                {% if form.show_location.help_text %}
                  <div class="form-text">{{ form.show_location.help_text }}</div>
                {% endif %}
                {% if form.show_location.errors %}
                  <div class="text-danger small">{{ form.show_location.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_phone }}
                <label class="form-check-label" for="{{ form.show_phone.id_for_label }}">Show my phone number</label>
                {% if form.show_phone.help_text %}
                  <div class="form-text">{{ form.show_phone.help_text }}</div>
                {% endif %}
                {% if form.show_phone.errors %}
                  <div class="text-danger small">{{ form.show_phone.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_education }}
                <label class="form-check-label" for="{{ form.show_education.id_for_label }}">Show my education</label>
                {% if form.show_education.help_text %}
                  <div class="form-text">{{ form.show_education.help_text }}</div>
                {% endif %}
                {% if form.show_education.errors %}
                  <div class="text-danger small">{{ form.show_education.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_work_experience }}
                <label class="form-check-label" for="{{ form.show_work_experience.id_for_label }}">Show my work experience</label>
                {% if form.show_work_experience.help_text %}
                  <div class="form-text">{{ form.show_work_experience.help_text }}</div>
                {% endif %}
                {% if form.show_work_experience.errors %}
                  <div class="text-danger small">{{ form.show_work_experience.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_links }}
                <label class="form-check-label" for="{{ form.show_links.id_for_label }}">Show my professional links</label>
                {% if form.show_links.help_text %}
                  <div class="form-text">{{ form.show_links.help_text }}</div>
                {% endif %}
                {% if form.show_links.errors %}
                  <div class="text-danger small">{{ form.show_links.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="form-check form-switch mb-3">
                {{ form.show_resume }}
                <label class="form-check-label" for="{{ form.show_resume.id_for_label }}">Allow recruiters to download my resume</label>
                {% if form.show_resume.help_text %}
                  <div class="form-text">{{ form.show_resume.help_text }}</div>
                {% endif %}
                {% if form.show_resume.errors %}
                  <div class="text-danger small">{{ form.show_resume.errors.0 }}</div>
                {% endif %}
              </div>
            </div>

            <div class="d-flex justify-content-between">
            <a href="{% url 'profiles:my_profile' %}" class="btn btn-outline-secondary">
              <i class="fas fa-arrow-left me-1"></i>Back to Profile
            </a>
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-1"></i>Update Profile
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    const locationSelect = document.getElementById('location-select');
    
    if (locationSelect) {
        locationSelect.addEventListener('change', function() {
            const selectedLocation = this.value;
            
            if (selectedLocation && selectedLocation !== '') {
                // Open job map in a new tab/window with the selected location
                const mapUrl = '{% url "jobs:map" %}';
                const newWindow = window.open(mapUrl, '_blank');
                
                // Show a message to the user
                const message = document.createElement('div');
                message.className = 'alert alert-info mt-3';
                message.innerHTML = `
                    <i class="fas fa-map-marker-alt me-2"></i>
                    <strong>Location updated!</strong> 
                    <a href="${mapUrl}" target="_blank" class="btn btn-sm btn-primary ms-2">
                        <i class="fas fa-map me-1"></i>View Jobs Map
                    </a>
                `;
                
                // Remove any existing message
                const existingMessage = document.querySelector('.alert-info');
                if (existingMessage) {
                    existingMessage.remove();
                }
                
                // Add the new message after the location field
                locationSelect.parentNode.parentNode.appendChild(message);
                
                // Auto-hide message after 5 seconds
                setTimeout(() => {
                    if (message.parentNode) {
                        message.remove();
                    }
                }, 5000);
            }
        });
    }
});
</script>
