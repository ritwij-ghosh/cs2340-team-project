{% extends 'base.html' %}
{% block content %}
<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2 class="mb-2">My Profile</h2>
          <p class="text-light">Manage your professional profile</p>
        </div>
        <div>
          <a href="{% url 'profiles:edit' %}" class="btn btn-outline-primary me-2">
            <i class="fas fa-edit me-1"></i>Edit Profile
          </a>
          <a href="{% url 'profiles:edit_user_info' %}" class="btn btn-outline-secondary">
            <i class="fas fa-user-cog me-1"></i>Account Info
          </a>
        </div>
      </div>

      {% if not profile.is_public %}
      <div class="alert alert-warning" role="alert">
        Your profile is currently hidden from recruiters. Turn on visibility in the privacy settings section when you are ready to share it.
      </div>
      {% else %}
      <div class="alert alert-info" role="alert">
        Your profile is visible to recruiters based on the privacy rules set below.
      </div>
      {% endif %}

      <div class="card bg-dark border-secondary profile-card">
        <div class="card-body text-light">
          <!-- Header Section -->
          <div class="row mb-4">
            <div class="col-md-8">
              <div class="d-flex align-items-center mb-3">
                <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 80px; height: 80px;">
                  <i class="fas fa-user fa-2x text-white"></i>
                </div>
                <div>
                  <h3 class="mb-1 text-light">{{ user.get_full_name|default:user.username }}</h3>
                  <h5 class="text-muted mb-2">{{ profile.headline }}</h5>
                  {% if profile.location %}
                    <p class="text-muted mb-0">
                      <i class="fas fa-map-marker-alt me-1"></i>{{ profile.location }}
                      {% if profile.location and not profile.show_location %}
                        <span class="badge bg-warning text-dark ms-2">Hidden from recruiters</span>
                      {% endif %}
                    </p>
                  {% endif %}
                </div>
              </div>
            </div>
            <div class="col-md-4 text-md-end">
              <div class="text-muted small">
                <div>Created: {{ profile.created_at|date:"M d, Y" }}</div>
                <div>Updated: {{ profile.updated_at|date:"M d, Y" }}</div>
              </div>
            </div>
          </div>

          <!-- Bio Section -->
          {% if profile.bio %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-user-circle me-2"></i>About Me
                </h5>
              <p class="mb-0 text-light">{{ profile.bio|linebreaks }}</p>
              {% if not profile.show_bio %}
                <div class="mt-2"><span class="badge bg-warning text-dark">Hidden from recruiters</span></div>
              {% endif %}
            </div>
          {% endif %}

          <!-- Skills Section -->
          <div class="mb-4">
            <h5 class="text-primary mb-3">
              <i class="fas fa-tools me-2"></i>Skills
            </h5>
            <div class="d-flex flex-wrap">
              {% for skill in profile.get_skills_list %}
                <span class="badge bg-secondary me-2 mb-2 fs-6">{{ skill }}</span>
              {% endfor %}
            </div>
          </div>

          <!-- Education Section -->
          <div class="mb-4">
            <h5 class="text-primary mb-3">
              <i class="fas fa-graduation-cap me-2"></i>Education
            </h5>
            <div class="bg-dark border rounded p-3">
              <p class="mb-0 text-light">{{ profile.education|linebreaks }}</p>
            </div>
            {% if not profile.show_education %}
              <div class="mt-2"><span class="badge bg-warning text-dark">Hidden from recruiters</span></div>
            {% endif %}
          </div>

          <!-- Work Experience Section -->
          <div class="mb-4">
            <h5 class="text-primary mb-3">
              <i class="fas fa-briefcase me-2"></i>Work Experience
            </h5>
            <div class="bg-dark border rounded p-3">
              <p class="mb-0 text-light">{{ profile.work_experience|linebreaks }}</p>
            </div>
            {% if not profile.show_work_experience %}
              <div class="mt-2"><span class="badge bg-warning text-dark">Hidden from recruiters</span></div>
            {% endif %}
          </div>

          <!-- Contact Information -->
          {% if profile.phone %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-phone me-2"></i>Contact Information
              </h5>
              <p class="mb-0 text-light">
                <i class="fas fa-phone me-2"></i>{{ profile.phone }}
              </p>
              {% if not profile.show_phone %}
                <div class="mt-2"><span class="badge bg-warning text-dark">Hidden from recruiters</span></div>
              {% endif %}
            </div>
          {% endif %}

          <!-- Links Section -->
          {% if profile.has_links %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-link me-2"></i>Professional Links
              </h5>
              <div class="row">
                {% if profile.linkedin_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.linkedin_url }}" target="_blank" class="btn btn-outline-primary w-100">
                      <i class="fab fa-linkedin me-2"></i>LinkedIn
                    </a>
                  </div>
                {% endif %}
                {% if profile.github_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.github_url }}" target="_blank" class="btn btn-outline-dark w-100">
                      <i class="fab fa-github me-2"></i>GitHub
                    </a>
                  </div>
                {% endif %}
                {% if profile.portfolio_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.portfolio_url }}" target="_blank" class="btn btn-outline-info w-100">
                      <i class="fas fa-globe me-2"></i>Portfolio
                    </a>
                  </div>
                {% endif %}
                {% if profile.other_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.other_url }}" target="_blank" class="btn btn-outline-secondary w-100">
                      <i class="fas fa-external-link-alt me-2"></i>Other
                    </a>
                  </div>
                {% endif %}
              </div>
              {% if not profile.show_links %}
                <div class="mt-2"><span class="badge bg-warning text-dark">Hidden from recruiters</span></div>
              {% endif %}
            </div>
          {% endif %}

          <!-- Privacy Summary -->
          <div class="mb-2">
            <h5 class="text-primary mb-3">
              <i class="fas fa-shield-alt me-2"></i>Privacy Settings Overview
            </h5>
            <ul class="list-unstyled small text-muted">
              <li><strong>Profile visibility:</strong> {{ profile.is_public|yesno:"Public to recruiters,Private - only visible to you" }}</li>
              <li><strong>Bio:</strong> {{ profile.show_bio|yesno:"Visible,Hidden" }}</li>
              <li><strong>Location:</strong> {{ profile.show_location|yesno:"Visible,Hidden" }}</li>
              <li><strong>Phone:</strong> {{ profile.show_phone|yesno:"Visible,Hidden" }}</li>
              <li><strong>Education:</strong> {{ profile.show_education|yesno:"Visible,Hidden" }}</li>
              <li><strong>Work experience:</strong> {{ profile.show_work_experience|yesno:"Visible,Hidden" }}</li>
              <li><strong>Professional links:</strong> {{ profile.show_links|yesno:"Visible,Hidden" }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}
