{% extends 'base.html' %}
{% block content %}
<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2 class="mb-2">{{ profile_user.get_full_name|default:profile_user.username }}</h2>
          <p class="text-muted">{{ profile.headline }}</p>
        </div>
        <div>
          {% if user.is_authenticated and not is_owner %}
            {% if user.user_profile.is_recruiter and profile_user.user_profile.is_job_seeker %}
              <a href="{% url 'communications:send_message' %}?recipient={{ profile_user.id }}" class="btn btn-primary me-2">
                <i class="fas fa-comments me-1"></i>Message Candidate
              </a>
            {% elif user.user_profile.is_job_seeker and profile_user.user_profile.is_recruiter %}
              <a href="{% url 'communications:send_message' %}?recipient={{ profile_user.id }}" class="btn btn-primary me-2">
                <i class="fas fa-comments me-1"></i>Message Recruiter
              </a>
            {% endif %}
          {% endif %}
          <a href="{% url 'profiles:index' %}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-1"></i>Back to Profiles
          </a>
        </div>
      </div>

      {% if is_owner %}
        <div class="alert alert-info" role="alert">
          You are previewing your profile exactly as recruiters will see it.
        </div>
      {% endif %}

      <div class="card bg-dark border-secondary profile-card">
        <div class="card-body text-light">
          <!-- Header Section -->
          <div class="row mb-4">
            <div class="col-md-8">
              <div class="d-flex align-items-center mb-3">
                <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 80px; height: 80px;">
                  <i class="fas fa-user fa-2x text-white"></i>
                </div>
                <div>
                  <h3 class="mb-1 text-light">{{ profile_user.get_full_name|default:profile_user.username }}</h3>
                  <h5 class="text-muted mb-2">{{ profile.headline }}</h5>
                  {% if profile.location and profile.show_location %}
                    <p class="text-muted mb-0">
                      <i class="fas fa-map-marker-alt me-1"></i>{{ profile.location }}
                    </p>
                  {% endif %}
                </div>
              </div>
            </div>
            <div class="col-md-4 text-md-end">
              <div class="text-muted small">
                <div>Member since: {{ profile_user.date_joined|date:"M d, Y" }}</div>
                <div>Profile updated: {{ profile.updated_at|date:"M d, Y" }}</div>
              </div>
            </div>
          </div>

          <!-- Bio Section -->
          {% if profile.bio and profile.show_bio %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-user-circle me-2"></i>About
              </h5>
              <p class="mb-0 text-light">{{ profile.bio|linebreaks }}</p>
            </div>
          {% endif %}

          <!-- Skills Section -->
          <div class="mb-4">
            <h5 class="text-primary mb-3">
              <i class="fas fa-tools me-2"></i>Skills
            </h5>
            <div class="d-flex flex-wrap">
              {% for skill in profile.get_skills_list %}
                <span class="badge bg-secondary me-2 mb-2 fs-6">{{ skill }}</span>
              {% endfor %}
            </div>
          </div>

          <!-- Education Section -->
          {% if profile.show_education %}
          <div class="mb-4">
            <h5 class="text-primary mb-3">
              <i class="fas fa-graduation-cap me-2"></i>Education
            </h5>
            <div class="bg-dark border rounded p-3">
              <p class="mb-0 text-light">{{ profile.education|linebreaks }}</p>
            </div>
          </div>
          {% endif %}

          <!-- Work Experience Section -->
          {% if profile.show_work_experience %}
          <div class="mb-4">
            <h5 class="text-primary mb-3">
              <i class="fas fa-briefcase me-2"></i>Work Experience
            </h5>
            <div class="bg-dark border rounded p-3">
              <p class="mb-0 text-light">{{ profile.work_experience|linebreaks }}</p>
            </div>
          </div>
          {% endif %}

          <!-- Contact Information -->
          {% if profile.phone and profile.show_phone %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-phone me-2"></i>Contact Information
              </h5>
              <p class="mb-0 text-light">
                <i class="fas fa-phone me-2"></i>{{ profile.phone }}
              </p>
            </div>
          {% endif %}

          <!-- Links Section -->
          {% if profile.has_public_links %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-link me-2"></i>Professional Links
              </h5>
              <div class="row">
                {% if profile.linkedin_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.linkedin_url }}" target="_blank" class="btn btn-outline-primary w-100">
                      <i class="fab fa-linkedin me-2"></i>LinkedIn
                    </a>
                  </div>
                {% endif %}
                {% if profile.github_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.github_url }}" target="_blank" class="btn btn-outline-dark w-100">
                      <i class="fab fa-github me-2"></i>GitHub
                    </a>
                  </div>
                {% endif %}
                {% if profile.portfolio_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.portfolio_url }}" target="_blank" class="btn btn-outline-info w-100">
                      <i class="fas fa-globe me-2"></i>Portfolio
                    </a>
                  </div>
                {% endif %}
                {% if profile.other_url %}
                  <div class="col-md-6 mb-2">
                    <a href="{{ profile.other_url }}" target="_blank" class="btn btn-outline-secondary w-100">
                      <i class="fas fa-external-link-alt me-2"></i>Other
                    </a>
                  </div>
                {% endif %}
              </div>
            </div>
          {% endif %}

          <!-- Resume Section -->
          {% if profile.has_public_resume %}
            <div class="mb-4">
              <h5 class="text-primary mb-3">
                <i class="fas fa-file-alt me-2"></i>Resume
              </h5>
              <div class="d-flex align-items-center">
                <a href="{{ profile.resume.url }}" target="_blank" class="btn btn-success">
                  <i class="fas fa-download me-2"></i>Download Resume
                </a>
                <span class="text-muted ms-3">
                  <i class="fas fa-file-pdf me-1"></i>{{ profile.resume.name|slice:"8:" }}
                </span>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}
